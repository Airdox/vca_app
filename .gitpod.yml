# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/introduction/learn-gitpod/gitpod-yaml)
# and commit this file to your remote git repository to share the goodness with others.

# Learn more from ready-to-use templates: https://www.gitpod.io/docs/introduction/getting-started/quickstart

tasks:
  - name: Setup Java and Android SDK and Build
    init: |
      echo "--- Initialisiere Java-Umgebung ---"
      sdk install java 17.0.10-tem || true
      sdk use java 17.0.10-tem
      echo "Java Version nach sdkman-Konfiguration (init-Phase):"
      java -version
      
      echo "--- Konfiguriere Android SDK ---"
      # Setze ANDROID_HOME f체r das Android SDK
      # Der Pfad /usr/local/android-sdk ist ein g채ngiger Ort in Gitpod-Umgebungen.
      export ANDROID_HOME="/usr/local/android-sdk"
      
      # Erstelle das Verzeichnis, falls es nicht existiert
      mkdir -p "$ANDROID_HOME"
      
      # Installiere Android Command Line Tools und Platform-Tools
      # Dies wird eine Weile dauern!
      echo "Installiere Android SDK Command Line Tools und Platform-Tools..."
      yes | /opt/android/sdk/cmdline-tools/latest/bin/sdkmanager --install "cmdline-tools;latest" "platform-tools" "build-tools;34.0.0" "platforms;android-34"
      
      # Akzeptiere die Android SDK Lizenzen
      echo "Akzeptiere Android SDK Lizenzen..."
      yes | /opt/android/sdk/cmdline-tools/latest/bin/sdkmanager --licenses
      
      # F체ge die Tools zum PATH hinzu
      export PATH="$ANDROID_HOME/cmdline-tools/latest/bin:$ANDROID_HOME/platform-tools:$ANDROID_HOME/emulator:$PATH"
      
      echo "ANDROID_HOME gesetzt auf: $ANDROID_HOME"
      echo "PATH angepasst."
      echo "Android SDK Installation abgeschlossen."
      
      echo "--- Starte Gradle Build ---"
      ./gradlew build
      echo "--- Gradle Build beendet ---"
    command: |
      echo "Bereit f체r Entwicklung. Build sollte bereits gelaufen sein."